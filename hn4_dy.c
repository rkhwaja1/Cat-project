#include "hn4.h"

int func(double t, const double y[], double f[],void *params)
{
  double c[28];
  int numPar;
  // roll out parameter values c[numPar]
  for (numPar=0;numPar<28;numPar++)
    {
      c[numPar]= *((double *)params+numPar);
    }
  
//dV
f[0]=-(c[0]*pow((1.0/(1.0+exp(-(y[0]+c[13])/7.8))),3)*y[1]*(y[0]-c[7])+ //Fast Sodium
c[1]*y[2]*y[3]*(y[0]-c[7])						//Slow Sodium
+c[3]*y[4]*y[4]*y[4]*y[4]*(y[0]-c[9])					//Potassium
+gCaS1*y[5]*y[5]*y[5]*y[6]*(y[0]-c[8])					//Slow Calcium
+c[4]*(y[0]-c[10])							//Leak
+c[6]*(y[0]-c[12])							//IMod
+c[5]*y[14]*(y[0]-c[11]))/0.001;					//synapse

//hNaF
f[1]=(1.0/(1.0+exp((y[0]+c[14])/7.0))-y[1])/(0.03/(exp((y[0]+c[14]+17.0)/15.0)+exp(-(y[0]+c[14]+17.0)/16.0)));
//mNaS
f[2]=(1.0/(1.0+exp(-(y[0]+c[15])/4.1))-y[2])/0.001;
//hNaS
f[3]=(1.0/(1.0+exp((y[0]+c[16])/5.0))-y[3])/c[22];    
//mK 
f[4]=(exp((y[0]+(c[19]+25.0))/40.0)+exp(-(y[0]+(c[19]+25.0))/50.0))/0.007*(1.0/(1.0+exp(-(y[0]+c[19])/15.0))-y[4]);
//mCaS 
f[5]=((1.0/(1.0+exp(-(y[0]+c[17])/4.27)))-y[5])/(0.001/((0.02*(y[0]+(c[17]+2.41))/(1.0-exp((-(c[17]+2.41)-y[0])/4.5)))+(0.05*(-(c[17]+5.41)-y[0])/(1.0-exp((y[0]+(c[17]+5.41))/4.5)))));
//f[5]=(((1.0/(1.0+exp(-(y[0]+c[17])/4.27)))-y[5])/TmCaS);

//hCaS
f[6]=(1.0/(1.0+exp((y[0]+c[18])/c[21]))-y[6])/c[23];
//dV2




f[7]=-(c[0]*pow((1.0/(1.0+exp(-(y[7]+c[13])/7.8))),3)*y[8]*(y[7]-c[7])
+c[1]*y[9]*y[10]*(y[7]-c[7])
+c[3]*y[11]*y[11]*y[11]*y[11]*(y[7]-c[9])
+gCaS2*y[12]*y[12]*y[12]*y[13]*(y[7]-c[8])
+c[4]*(y[7]-c[10])
+c[6]*(y[7]-c[12])*c[25]
+c[5]*y[15]*(y[7]-c[11]))/0.001;


//hNaF2
f[8]=(1.0/(1.0+exp((y[7]+c[14])/7.0))-y[8])/(0.03/(exp((y[7]+c[14]+17.0)/15.0)+exp(-(y[7]+c[14]+17.0)/16.0)));
//mNaS2
f[9]=(1.0/(1.0+exp(-(y[7]+c[15])/4.1))-y[9])/0.001;
//hNaS2
f[10]=(1.0/(1.0+exp((y[7]+c[16])/5.0))-y[10])/c[22];    
//mK 2
f[11]=(exp((y[7]+(c[19]+25.0))/40.0)+exp(-(y[7]+(c[19]+25.0))/50.0))/0.007*(1.0/(1.0+exp(-(y[7]+c[19])/15.0))-y[11]);
//mCaS 2
f[12]=((1.0/(1.0+exp(-(y[7]+c[17])/4.27)))-y[12])/(0.001/((0.02*(y[7]+(c[17]+2.41))/(1.0-exp((-(c[17]+2.41)-y[7])/4.5)))+(0.05*(-(c[17]+5.41)-y[7])/(1.0-exp((y[7]+(c[17]+5.41))/4.5)))));
//f[12]=(((1.0/(1.0+exp(-(y[7]+c[17])/4.27)))-y[12])/TmCaS);

//hCaS2
f[13]=(1.0/(1.0+exp((y[7]+c[18])/c[21]))-y[13])/c[23];

//synapse from neuron 2 onto neuron 1
f[14]=(1.0/(1.0+exp(-(y[7]+c[20])/0.4))-y[14])/c[24];

//synapse from neuron 1 onto neuron 2
f[15]=(1.0/(1.0+exp(-(y[0]+c[20])/0.4))-y[15])/c[24];





  return GSL_SUCCESS;
}
